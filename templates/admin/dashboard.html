{% extends 'base.html' %}

{% block title %}Panel de AdministraciÃ³n - Estudify{% endblock %}

{% block content %}
<h2>ðŸ“Š Panel de AdministraciÃ³n</h2>

<div class="stats-grid">
    <div class="stat-card">
        <div class="stat-value">{{ total_estudiantes }}</div>
        <div class="stat-label">Estudiantes Activos</div>
    </div>
    <div class="stat-card">
        <div class="stat-value">{{ total_docentes }}</div>
        <div class="stat-label">Docentes Activos</div>
    </div>
    <div class="stat-card">
        <div class="stat-value">{{ total_cursos }}</div>
        <div class="stat-label">Cursos Activos</div>
    </div>
    <div class="stat-card">
        <div class="stat-value">{{ total_materias }}</div>
        <div class="stat-label">Materias Activas</div>
    </div>
    <div class="stat-card">
        <div class="stat-value">{{ promedio_general }}</div>
        <div class="stat-label">Promedio General</div>
    </div>
    <div class="stat-card">
        <div class="stat-value">{{ porcentaje_asistencia }}%</div>
        <div class="stat-label">Asistencia Mensual</div>
    </div>
</div>

<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.5rem; margin-bottom: 2rem;">
    <div class="card" style="text-align: center;">
        <h3 style="margin-bottom: 1rem;">ðŸ‘¥ Usuarios</h3>
        <p style="color: #718096; margin-bottom: 1.5rem;">Gestiona estudiantes y docentes</p>
        <a href="{% url 'admin_usuarios_lista' %}" class="btn btn-primary" style="margin-right: 0.5rem;">Ver Usuarios</a>
        <a href="{% url 'admin_usuario_crear' %}" class="btn btn-success">âž• Crear Usuario</a>
    </div>

    <div class="card" style="text-align: center;">
        <h3 style="margin-bottom: 1rem;">ðŸŽ“ Cursos</h3>
        <p style="color: #718096; margin-bottom: 1.5rem;">Administra los cursos del sistema</p>
        <a href="{% url 'admin_cursos_lista' %}" class="btn btn-primary" style="margin-right: 0.5rem;">Ver Cursos</a>
        <a href="{% url 'admin_curso_crear' %}" class="btn btn-success">âž• Crear Curso</a>
    </div>

    <div class="card" style="text-align: center;">
        <h3 style="margin-bottom: 1rem;">ðŸ“š Materias</h3>
        <p style="color: #718096; margin-bottom: 1.5rem;">Gestiona las materias y asigna docentes</p>
        <a href="{% url 'admin_materias_lista' %}" class="btn btn-primary" style="margin-right: 0.5rem;">Ver Materias</a>
        <a href="{% url 'admin_materia_crear' %}" class="btn btn-success">âž• Crear Materia</a>
    </div>
</div>

<div class="card">
    <h3>ðŸŽ“ Cursos con MÃ¡s Estudiantes</h3>
    <table>
        <thead>
            <tr>
                <th>Curso</th>
                <th>AÃ±o Escolar</th>
                <th>Estudiantes</th>
                <th>Estado</th>
            </tr>
        </thead>
        <tbody>
            {% for curso in cursos_populares %}
            <tr>
                <td><strong>{{ curso.nombre }}</strong></td>
                <td>{{ curso.aÃ±o_escolar }}</td>
                <td>{{ curso.num_estudiantes }}</td>
                <td>
                    {% if curso.activo %}
                    <span class="badge badge-success">Activo</span>
                    {% else %}
                    <span class="badge badge-danger">Inactivo</span>
                    {% endif %}
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="4" style="text-align: center; color: #7f8c8d;">No hay cursos registrados</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<div class="card">
    <h3>ðŸ‘¥ Estudiantes Recientes</h3>
    <table>
        <thead>
            <tr>
                <th>Usuario</th>
                <th>Nombre Completo</th>
                <th>Email</th>
                <th>Fecha de Registro</th>
                <th>Estado</th>
            </tr>
        </thead>
        <tbody>
            {% for estudiante in estudiantes_recientes %}
            <tr>
                <td><strong>{{ estudiante.username }}</strong></td>
                <td>{{ estudiante.get_full_name|default:"-" }}</td>
                <td>{{ estudiante.email|default:"-" }}</td>
                <td>{{ estudiante.date_joined|date:"d/m/Y" }}</td>
                <td>
                    {% if estudiante.is_active %}
                    <span class="badge badge-success">Activo</span>
                    {% else %}
                    <span class="badge badge-danger">Inactivo</span>
                    {% endif %}
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="5" style="text-align: center; color: #7f8c8d;">No hay estudiantes registrados</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
